<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <link href="https://github.com/json-com/json-com.github.io/edit/master/" rel="edit-form" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>JSON Community</title>
  <meta name="description" content="JSON.com is a collection of JSON related content, links, and general awesomeness hand selected by the good people of the Web. The original json.com site has ...">

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <link rel="canonical" href="/2013/05/21/get-more-bang-for-your-relational-buck">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- Atom & RSS -->
  <link rel="alternate" type="application/atom+xml" title="JSON Community" href="/atom.xml">
  <link rel="alternate" type="application/rss+xml" title="JSON Community" href="/feed.xml" />
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <img src="/public/apple-touch-icon-precomposed.png" />
    <p>JSON.com is a collection of JSON related content, links, and general awesomeness hand selected by the good people of the Web. The original json.com site has been <a href="http://web.archive.org/web/20150503020228/https://www.json.com/"> archived</a>.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    <a class="sidebar-nav-item" href="/about/">About</a>
    <a class="sidebar-nav-item" href="/archives/">Archives</a>
    <a class="sidebar-nav-item" href="/specs/">Specifications</a>

    
      <a class="sidebar-nav-item" href="https://github.com/json-com">
        <span class="icon icon--github">
          <svg viewBox="0 0 16 16" width="1em" height="1em" style="vertical-align: middle">
            <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
          </svg>
        </span>

        <span class="username">json-com</span>
      </a>
    

    

  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2024. Apache License 2.0.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">JSON Community</a>
            <small></small>
          </h3>
        </div>
      </div>

      <div class="container content">
        
<div class="post">
  <h1 class="post-title">Get More Bang for Your Relational Buck</h1>
  <span class="post-date">21 May 2013</span>
  <p>From time to time, your data models might suffer from field creep � you
have to keep adding more and more fields to your models to work around
edge cases and unique business requirements.</p>
<p>In the world of relational databases, this usually manifests either as
additional fields tacked onto an existing table, or a separate &quot;detail&quot;
table with a one-to-one relation to its corresponding source model � and
these are just the least complicated approaches; there are far more
complex ways to address the situation!</p>
<p><img src="/img/posts/93-relational-1.png" alt="Relational Schema 1"></p>
<p><em>One approach to addressing the need for ever-more-specific-use-case
fields: add more (increasingly ridiculously-named) fields to the table.</em></p>
<p><img src="/img/posts/93-relational-2.png" alt="Relational Schema 2"></p>
<p><em>An alternate approach: move all of those pesky &quot;detail&quot; fields into a
separate table that you can hide away in the closet whenever company
comes over.</em></p>
<p>In addition to cluttering up your ERD, you are also leveraging the power
(and overhead!) of your relational database engine for things that don't
actually need it.</p>
<p>Your pet store application might never need to filter a select query by
userstory183274_marker value, but thanks to user story 183274, you
still have to store that information with each pet.</p>
<p>Perhaps there's another approach, one that is more scalable and doesn't
clutter up your database tables with (almost) useless fields... and yet
still makes this custom information accessible to your application.</p>
<p>Well, as it happens, there is! Combine all of those extra &quot;detail&quot;
fields into a single detail field that uses – you guessed it – JSON to
store key/value pairs!</p>
<p><img src="/img/posts/93-relational-3.png" alt="Relational Schema 3"></p>
<p>Much easier on the eyes!</p>
<p>Let's peek at some values in our newly JSON-ified Pet table:</p>
<table>
<thead>
<tr>
<th>pet_id</th>
<th>owner_id</th>
<th>species_id</th>
<th>name</th>
<th>detail</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>1</td>
<td>'Bowser'</td>
<td><code>{&quot;collar_manufacturer&quot;: &quot;PetProtector&quot;, &quot;rabies_flag&quot;: true}</code></td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>2</td>
<td>'Oliver'</td>
<td><code>{&quot;has_name_tag&quot;: false, &quot;music_preference&quot;: &quot;Light Jazz&quot;}</code></td>
</tr>
<tr>
<td>3</td>
<td>2</td>
<td>1</td>
<td>'Marcus'</td>
<td><code>{&quot;userstory183274_marker&quot;: &quot;FILENOTFOUND&quot;}</code></td>
</tr>
</tbody>
</table>
<p><em>Notice that in the time it took to draft up this table, we added a new
feature: Musical Preference. Oliver likes Light Jazz.</em></p>
<p>Some of the benefits of storing &quot;extra&quot; data about your models this way:</p>
<ul>
<li>You can add additional properties without having to alter your
database schema.</li>
<li>Keeps your database schema tidy; only &quot;essential&quot; fields show up in
your tables.</li>
</ul>
<p>There are a few costs to this approach that you should be aware of,
however:</p>
<ul>
<li>It requires additional application logic to encode/decode the JSON
in the detail field. This has implications both for performance and
development time.</li>
<li>These fields are not indexable! If you need to search/filter by a
property in a detail field, you will need to move it to its own
column in the database table or use a system such as Lucene to index
and search that value.</li>
<li>Extracting data from a detail field is an all-or-nothing operation;
you have to pull the entire JSON string from the database and decode
it in your application to find a specific property. This is usually
not an issue for modern ORMs, since all columns are usually
automatically pulled in every time they fetch a record from
the database.</li>
</ul>
<p>For storing one-off properties and flag values that you only need at the
application level (i.e., you do not need to index/filter/search these
values), think about whether you can store these values in a single
JSON-formatted string instead of bloating your tables with extra fields.</p>
<p>And if you find that you're using this feature a lot in your
relational-database-powered application, you might want to consider
whether a NoSQL solution such as CouchDB is a better fit for some or all
of your data!</p>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
    
      <li>
        <h3>
          <a href="/2013/05/20/write-a-better-config-file">
            Write a Better Config File
            <small>20 May 2013</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
